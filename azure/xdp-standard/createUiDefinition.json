{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Compute.MultiVm",
  "version": "0.1.2-preview",
  "parameters": {
    "basics": [
        {
            "name": "clusterName",
            "type": "Microsoft.Common.TextBox",
            "label": "Name",
            "defaultValue": "xdp-standard",
            "toolTip": "",
            "constraints": {
                "required": true,
                "regex": "^[a-z0-9A-Z-]{1,54}$",
                "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-54 characters long."
            },
            "visible": true
        },
        {
        "name": "licenseKey",
        "type": "Microsoft.Common.TextBox",
        "label": "License Key",
        "defaultValue": "",
        "toolTip": "Contact Xcalar at info@xcalar.com to request for a trial license if you don't have one. You may access Xcalar's customer portal at https://myxcalar.zendesk.com, to access your license keys.",
        "constraints": {
          "required": true,
          "regex": "^[ABCDEFGHJKLMNPQRSTUVWXYZ23456789]{173}[a-z=]{8}",
          "validationMessage": "Must specify a valid license key matching [ABCDEFGHJKLMNPQRSTUVWXYZ23456789]{173}[a-z=]{8}"
        },
        "options": {},
        "visible": true
      },
      {
        "name": "scaleNumber",
        "type": "Microsoft.Common.DropDown",
        "label": "Number of nodes",
        "defaultValue": "1",
        "toolTip": "Xcalar Data Platform Standard Edition supports up to 16 nodes",
        "constraints": {
          "allowedValues": [{
              "label": "1",
              "value": "1"
            },
            {
              "label": "2",
              "value": "2"
            },
            {
              "label": "3",
              "value": "3"
            },
            {
              "label": "4",
              "value": "4"
            },
            {
              "label": "5",
              "value": "5"
            },
            {
              "label": "6",
              "value": "6"
            },
            {
              "label": "7",
              "value": "7"
            },
            {
              "label": "8",
              "value": "8"
            },
            {
              "label": "9",
              "value": "9"
            },
            {
              "label": "10",
              "value": "10"
            },
            {
              "label": "11",
              "value": "11"
            },
            {
              "label": "12",
              "value": "12"
            },
            {
              "label": "13",
              "value": "13"
            },
            {
              "label": "14",
              "value": "14"
            },
            {
              "label": "15",
              "value": "15"
            },
            {
              "label": "16",
              "value": "16"
            }
          ]
        },
        "options": {},
        "visible": true
      },
      {
        "name": "adminUsername",
        "type": "Microsoft.Common.TextBox",
        "label": "Username (Case Sensitive)",
        "toolTip": "Enter username to be used for administrating the cluster",
        "constraints": {
          "required": true,
          "regex": "^[A-Za-z][A-Za-z0-9_\\.-]+[A-Za-z0-9]$",
          "validationMessage": "Must be a valid user name matching ^[A-Za-z][A-Za-z0-9_\\.-]+[A-Za-z0-9]$"
        },
        "options": {},
        "visible": true
      },
      {
        "name": "adminPassword",
        "type": "Microsoft.Common.PasswordBox",
        "label": {
          "password": "Password",
          "confirmPassword": "Confirm password"
        },
        "toolTip": "",
        "constraints": {
          "required": true
        },
        "options": {
          "hideConfirmation": false
        },
        "visible": true
      },
      {
        "name": "adminEmail",
        "type": "Microsoft.Common.TextBox",
        "label": "Email address",
        "toolTip": "Enter an email address to which notifications about the deployment will be sent",
        "constraints": {
          "required": true,
          "regex": "^\\S+@\\S+[\\.][0-9a-z]+$",
          "validationMessage": "Must be a valid email address"
        },
        "options": {},
        "visible": true
      }
    ],
    "steps": [{
      "name": "firstStep",
      "label": "Settings",
      "bladeTitle": "Settings",
      "subLabel": {
        "preValidation": "Configure additional options",
        "postValidation": "Done"
      },
      "elements": [{
          "name": "vmSize",
          "type": "Microsoft.Compute.SizeSelector",
          "label": "Size",
          "toolTip": "",
          "recommendedSizes": [
            "Standard_DS14_v2",
            "Standard_E16s_v3",
            "Standard_E8s_v3"
          ],
          "count": "[basics('scaleNumber')]",
          "osPlatform": "Linux",
          "visible": true
        },
        {
          "name": "vmDiskType",
          "type": "Microsoft.Common.OptionsGroup",
          "label": "VM disk type",
          "defaultValue": "SSD",
          "toolTip": "Premium disks (SSD) are backed by solid state drives and offer consistent, low-latency performance. They provide the best balance between price and performance, and are ideal for I/O-intensive applications and production workloads. Standard disks (HDD) are backed by magnetic drives and are preferable for applications where data is accessed infrequently.",
          "constraints": {
            "allowedValues": [{
                "label": "SSD",
                "value": "Premium_LRS"
              },
              {
                "label": "HDD",
                "value": "Standard_LRS"
              }
            ]
          },
          "visible": true
        },
        {
          "name": "publicIP",
          "type": "Microsoft.Network.PublicIpAddressCombo",
          "label": {
            "publicIpAddress": "Public IP address",
            "domainNameLabel": "Domain name label"
          },
          "toolTip": {
            "publicIpAddress": "",
            "domainNameLabel": ""
          },
          "defaultValue": {
            "publicIpAddressName": "XcalarIP",
            "domainNameLabel": ""
          },
          "constraints": {
            "required": {
              "domainNameLabel": true
            }
          },
          "options": {
            "hideNone": true,
            "hideDomainNameLabel": false,
            "hideExisting": false
          },
          "visible": true
        }
      ]
    }],
    "outputs": {
      "location": "[location()]",
      "clusterName": "[basics('clusterName')]",
      "licenseKey": "[basics('licenseKey')]",
      "scaleNumber": "[int(basics('scaleNumber'))]",
      "adminUsername": "[basics('adminUsername')]",
      "adminPassword": "[basics('adminPassword')]",
      "adminEmail": "[basics('adminEmail')]",
      "vmDiskType": "[steps('firstStep').vmDiskType]",
      "domainNameLabel": "[steps('firstStep').publicIP.domainNameLabel]",
      "vmSize": "[steps('firstStep').vmSize]"
    }
  }
}
